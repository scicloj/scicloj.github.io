<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=preload as=font href=https://scicloj.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://scicloj.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://scicloj.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script>(()=>{var b=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,a=localStorage.getItem("theme");b&&a===null&&(localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-dark-mode","")),b&&a==="dark"&&document.documentElement.setAttribute("data-dark-mode",""),a==="dark"&&document.documentElement.setAttribute("data-dark-mode","")})()</script><link rel=stylesheet href=https://scicloj.github.io/main.41d23ac47b7e9305201eeb25c0d4cc1281cd90be5b4b8ad089763ba733ddba12c20de4c56adc651821615da7157987497f5e95b8d9a94ddbabca077dcb4b80bd.css integrity="sha512-QdI6xHt+kwUgHuslwNTMEoHNkL5bS4rQiXY7pzPduhLCDeTFatxlGCFhXacVeYdJf16VuNmpTdurygd9y0uAvQ==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Predict real vs. fake disaster tweets - Scicloj</title><meta name=description content="Any a little bit more serious machine learning, like participating in a Kaggle competition, requires in my view a form of ML experiment tracking.
As ML requires a lot of different trying of code, models and hyper-parameters, we need to have a tools which keeps track of this.
These type of tools can be programming language independent, as they see the code (whatever code) such as one of the assets to track (among hyper-parameters, performance metrics and data)"><link rel=canonical href=https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Predict real vs. fake disaster tweets"><meta property="og:description" content="Any a little bit more serious machine learning, like participating in a Kaggle competition, requires in my view a form of ML experiment tracking.
As ML requires a lot of different trying of code, models and hyper-parameters, we need to have a tools which keeps track of this.
These type of tools can be programming language independent, as they see the code (whatever code) such as one of the assets to track (among hyper-parameters, performance metrics and data)"><meta property="og:url" content="https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/"><meta property="og:site_name" content="Scicloj"><meta property="article:published_time" content="2022-09-10T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-10T00:00:00+00:00"><meta property="og:image" content="https://scicloj.github.io/"><meta property="og:image:alt" content="Scicloj"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@scicloj"><meta name=twitter:creator content="@daslu_"><meta name=twitter:title content="Predict real vs. fake disaster tweets"><meta name=twitter:description content><meta name=twitter:image content="https://scicloj.github.io/"><meta name=twitter:image:alt content="Predict real vs. fake disaster tweets"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://scicloj.github.io/#/schema/organization/1","name":"Doks","url":"https://scicloj.github.io/","sameAs":["https://twitter.com/getdoks","https://github.com/h-enk/doks"],"logo":{"@type":"ImageObject","@id":"https://scicloj.github.io/#/schema/image/1","url":"https://scicloj.github.io/logo-doks.png","width":512,"height":512,"caption":"Doks"},"image":{"@id":"https://scicloj.github.io/#/schema/image/1"}},{"@type":"WebSite","@id":"https://scicloj.github.io/#/schema/website/1","url":"https://scicloj.github.io/","name":"Scicloj","description":"Scicloj is building a stack of Clojure libraries for data science, and scientific computing.","publisher":{"@id":"https://scicloj.github.io/#/schema/organization/1"}},{"@type":"WebPage","@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/","url":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/","name":"Predict real vs. fake disaster tweets","description":"","isPartOf":{"@id":"https://scicloj.github.io/#/schema/website/1"},"about":{"@id":"https://scicloj.github.io/#/schema/organization/1"},"datePublished":"2022-09-10T00:00:00CET","dateModified":"2022-09-10T00:00:00CET","breadcrumb":{"@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/#/schema/breadcrumb/1"},"primaryImageOfPage":{"@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/#/schema/image/2"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/"]}]},{"@type":"BreadcrumbList","@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/#/schema/breadcrumb/1","name":"Breadcrumbs","itemListElement":[{"@type":"ListItem","position":1,"item":{"@type":"WebPage","@id":"https://scicloj.github.io/","url":"https://scicloj.github.io/","name":"Home"}},{"@type":"ListItem","position":2,"item":{"@type":"WebPage","@id":"https://scicloj.github.io/blog/","url":"https://scicloj.github.io/blog/","name":"Blog"}},{"@type":"ListItem","position":3,"item":{"@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Article","@id":"https://scicloj.github.io/#/schema/article/1","headline":"Predict real vs. fake disaster tweets","description":"","isPartOf":{"@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/"},"mainEntityOfPage":{"@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/"},"datePublished":"2022-09-10T00:00:00CET","dateModified":"2022-09-10T00:00:00CET","author":{"@id":"https://scicloj.github.io/#/schema/person/2"},"publisher":{"@id":"https://scicloj.github.io/#/schema/organization/1"},"image":{"@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/#/schema/image/2"}}]},{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://scicloj.github.io/#/schema/person/2","name":"Henk Verlinde","sameAs":["https://twitter.com/henkverlinde","https://www.linkedin.com/in/henkverlinde/","https://github.com/h-enk"]}]},{"@context":"https://schema.org","@graph":[{"@type":"ImageObject","@id":"https://scicloj.github.io/blog/predict-real-vs.-fake-disaster-tweets/#/schema/image/2","url":"https://scicloj.github.io/","contentUrl":"https://scicloj.github.io/","caption":"Predict real vs. fake disaster tweets"}]}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=https://scicloj.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://scicloj.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://scicloj.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://scicloj.github.io/site.webmanifest></head><body class="blog single"><div class=header-bar></div><header class="navbar navbar-expand-md navbar-light doks-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-auto" href=https://scicloj.github.io/ aria-label=Scicloj><img height=60 src=https://scicloj.github.io/sci-cloj-logo-transparent.png class="navbar-brand p-0 me-auto" href=https://scicloj.github.io/ aria-label=Scicloj></img></a>
<button class="btn btn-menu d-block d-md-none order-5" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasDoks aria-controls=offcanvasDoks aria-label="Open main menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button><div class="offcanvas offcanvas-start border-0 py-md-1" tabindex=-1 id=offcanvasDoks data-bs-backdrop=true aria-labelledby=offcanvasDoksLabel><div class="header-bar d-md-none"></div><div class="offcanvas-header d-md-none"><h2 class="h5 offcanvas-title ps-2" id=offcanvasDoksLabel><a class=text-dark href=https://scicloj.github.io/>Scicloj</a></h2><button type=button class="btn-close text-reset me-2" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class="offcanvas-body px-4"><h3 class="h6 text-uppercase mb-3 d-md-none">Main</h3><ul class="nav flex-column flex-md-row ms-md-n3"><li class=nav-item><a class="nav-link ps-0 py-1 active" href=https://scicloj.github.io/blog/>Blog</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Community
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://scicloj.github.io/docs/community/about/>About Scicloj</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/community/getting_involved/>Getting involved</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/community/groups/>Dev & Study groups</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/community/chat/>Chat Streams</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/community/events/>Events</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/community/contact/>Contact</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle ps-0 py-1" href=# id=navbarDropdownMenuLink role=button data-bs-toggle=dropdown aria-expanded=false>Resources
<span class=dropdown-caret><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-down"><polyline points="6 9 12 15 18 9"/></svg></span></a><ul class="dropdown-menu dropdown-menu-main shadow rounded border-0" aria-labelledby=navbarDropdownMenuLink><li><a class=dropdown-item href=https://scicloj.github.io/docs/resources/libs>Tools & libraries</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/resources/reading>Reading</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/resources/video>Video</a></li><li><a class=dropdown-item href=https://scicloj.github.io/docs/resources/audio>Audio</a></li></ul></li></ul><hr class="text-black-50 my-4 d-md-none"><h3 class="h6 text-uppercase mb-3 d-md-none">Socials</h3><ul class="nav flex-column flex-md-row ms-md-auto me-md-n5 pe-md-2"><li class=nav-item><a class="nav-link ps-0 py-1" href=https://github.com/scicloj><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li><li class=nav-item><a class="nav-link ps-0 py-1" href=https://twitter.com/scicloj><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg><small class="ms-2 d-md-none">Twitter</small></a></li></ul></div></div><button id=mode class="btn btn-link order-md-1" type=button aria-label="Toggle user interface mode">
<span class=toggle-dark><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg></span><span class=toggle-light><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></span></button></nav></header><div class="wrap container-xxl" role=document><div class=content><div class="row justify-content-center"><div class="col-md-12 col-lg-10 col-xl-8"><article><div class=blog-header><h1>Predict real vs. fake disaster tweets</h1><p><small>Posted September 10, 2022 by <a class="stretched-link position-relative" href=https://scicloj.github.io/contributors/behrica/>behrica</a>&nbsp;&dash;&nbsp;<strong>3&nbsp;min read</strong></small><p></div><p class=lead>Predict real vs. fake disaster tweets with dvc, Clojure and python</p><p>Any a little bit more serious machine learning,
like participating in a Kaggle competition, requires in my view a form
of ML experiment tracking.</p><p>As ML requires a lot of different trying of code,
models and hyper-parameters, we need to have a tools which keeps track of this.</p><p>These type of tools can be programming language independent,
as they see the code (whatever code) such as one of the assets
to <strong>track</strong> (among hyper-parameters, performance metrics and data)</p><p>One such open source tool is
<a href=http://dvc.org>DVC - Data Version Control</a></p><p>In my view this tools is very relevant for ML in Clojure, due to its main
characteristics:</p><p><strong>A DVC pipeline is based on steps , where each step is a shell script
(so can be written in Clojure as well)</strong></p><p>It therefore allows a different form of <code>interop</code>, in which certain steps
are written in Python / R (the modeling step for example) while
preprocessing is done in Clojure.
This makes a lot of sense, as the pure modeling is often a few lines only
and is tricky to use via interop (due to multithreading, GPU usage, long
running). We can reduce the python code to the concrete single-line
call to &ldquo;train(&mldr;)&rdquo; if we want.</p><p>The different steps can then communicate via data files on disk.
(arrow is a good format for this, as supported by Clojure via
tablecloth/dataset, python and R.</p><p>DVC takes care of these inter-step-dependencies, and only reruns what has changed.
The details of this are in the DVC documentation.</p><p>In the following DVC pipeline I have 3 steps, 2 in Clojure,
one in Python.</p><ul><li>preprocess: Done in pure Clojure using <a href=https://scicloj.github.io/tablecloth/index.html>tablecloth</a></li><li>train: Done in pure python with <a href=https://simpletransformers.ai/>simpletransformers</a>, reading the data files produced in preprocess and train the model</li><li>predict_kaggle: Done in Clojure, but using <code>simpletransformers</code>
python library via <a href=https://github.com/clj-python/libpython-clj>libpython-clj</a></li></ul><pre><code class=language-yaml>stages:
  preprocess:
    cmd: clj preprocess.clj
    deps:
      - preprocess.clj
      - train.csv
      - test.csv
    outs:
      - train.arrow
      - test.arrow


  train:
    cmd: python train.py
    deps:
      - train.py
      - train.arrow
      - test.arrow
    outs:
      - outputs
    metrics:
      - eval.json
    params:
      - train.num_train_epochs
      - train.model_type
      - train.model_name
      - train.train_batch_size


  predict_kaggle:
     cmd: clj predict_kaggle.clj
     deps:
       - outputs
       - predict_kaggle.clj
     outs:
       - kaggle_submission.csv
</code></pre><p>The reason why I did step 2 in pure python is stability.
I did not want to use <code>libpython-clj</code> for eventually very long running training runs.
It has some issues with <a href=https://simpletransformers.ai/>simpletransformers</a> based on PyTorch</p><p>Using a pre-trained <a href=https://huggingface.co/roberta-base>roberta</a> model from the huggingface hub,
and a bit of preprocessing
gave me a score of 0.82 and position 119 in the leader board.</p><p>So even though that Kaggle does not support Clojure
(in the web notebook interface),
we can use Clojure to participate in Kaggle competitions.</p><p>We could of course implement the &ldquo;train&rdquo; step in Clojure as well,
in case we want to use a model from:</p><ul><li>Clojure (using <a href=https://github.com/scicloj/scicloj.ml>scicloj.ml</a> for example)</li><li>Java (via Clojure interop)</li><li>python (using <a href=https://github.com/clj-python/libpython-clj>libpython-clj</a>)</li><li>R (using <a href=https://github.com/scicloj/clojisr>clojisr</a>)</li></ul><p>I suggest to use dvc and a multi-step pipeline even in a pure JVM (Clojure + Java) setup.
It nicely structures the work and is able to track all assets.</p><p>References:</p><ul><li><a href=https://www.kaggle.com/competitions/nlp-getting-started>Kaggle competition</a></li><li><a href=https://github.com/behrica/predict_disaster_tweet/tree/prepareDemo>full code</a></li></ul></article></div></div></div></div><footer class="footer text-muted"><div class=container-xxl><div class=row><div class="col-lg-8 order-last order-lg-first"><ul class=list-inline><li class=list-inline-item>Powered by <a class=text-muted href=https://www.netlify.com/>Netlify</a>, <a class=text-muted href=https://gohugo.io/>Hugo</a>, and <a class=text-muted href=https://getdoks.org/>Doks</a></li></ul></div><div class="col-lg-8 order-first order-lg-last text-lg-end"><ul class=list-inline></ul></div></div></div></footer><script src=https://scicloj.github.io/js/bootstrap.min.fdbe9b9ba88a036135318f3c721784d684ac9e3280fe282cc80d7d49f7f9c82780cd54228c1608685a230c09984300d7946fc471734d566fcebc148b65bd16db.js integrity="sha512-/b6bm6iKA2E1MY88cheE1oSsnjKA/igsyA19Sff5yCeAzVQijBYIaFojDAmYQwDXlG/EcXNNVm/OvBSLZb0W2w==" crossorigin=anonymous defer></script>
<script src=https://scicloj.github.io/js/highlight.min.2bffd851168ecbbf28174aa9c2250a9f4f720f8e3b4d83c7d3fead6b626f041aca6675601c165b6f05db01e49a8bb5e5dee21006f8ef0dd710831f3210620c1a.js integrity="sha512-K//YURaOy78oF0qpwiUKn09yD447TYPH0/6ta2JvBBrKZnVgHBZbbwXbAeSai7Xl3uIQBvjvDdcQgx8yEGIMGg==" crossorigin=anonymous defer></script>
<script src=https://scicloj.github.io/main.min.6bcd117899ffc9e0f284a6a38e48794689fd80fbd8a0a50a6c886e47e1bfac6c90f39ecad7cdc1a52f577e7c99ed379a3b3b84adb674a5776d815dd650d71eb6.js integrity="sha512-a80ReJn/yeDyhKajjkh5Ron9gPvYoKUKbIhuR+G/rGyQ857K183BpS9XfnyZ7TeaOzuErbZ0pXdtgV3WUNcetg==" crossorigin=anonymous defer></script></body></html>